# CLIw25Q80

Проект управления serial SPI FLASH w25Q80 эмуляция EEPROM по средствам консоли redLine CLI

Поддерживаются следующие операции: стирание всей микросхемы, стирание и перезапись произвольных байтов из потока консоли

Для управления процессами используется консоль redline CLI для MCU без RTOS с памятью комманд, редактором; 
(https://github.com/NetDm/CLIw25Q80/blob/master/UserCodes/CLIcommands.c) - удобным общим файлом содержащий реализации и список комманд, мануалы к ним показываются при вызове man, см вывод команды: man man

Пример истирания флеш по произвольным адресам с сохранением прочего содержимого секторов:
<p align="center">
  <img src="https://github.com/NetDm/MCU-CLI-w25Q80-emulEEPROM/blob/master/remarks/%D0%BF%D0%B5%D1%80%D0%B5%D0%B7%D0%B0%D0%BF%D0%B8%D1%81%D1%8C%20%D0%B2%202%20%D1%81%D0%B5%D0%BA%D1%82%D0%BE%D1%80%D0%B0%202%20%D1%80%D0%B0%D0%B7%D0%BD%D1%8B%D1%85%20%D0%BF%D0%B0%D0%BA%D0%B5%D1%82%D0%B0%20%D0%B8%203%D0%B9%20%D0%B2%20%D1%85%D0%B2%D0%BE%D1%81%D1%82%20%D1%84%D0%BB%D0%B5%D1%88.gif?raw=true" />
</p>
Пример перезаписи данных в произвольные адрес, обращение при записи в различные сектора:
<p align="center">
  <img src="https://github.com/NetDm/MCU-CLI-w25Q80-emulEEPROM/blob/master/remarks/%D1%81%D1%82%D0%B8%D1%80%D0%B0%D0%BD%D0%B8%D0%B5%20%D0%B2%20%D1%85%D0%B2%D0%BE%D1%81%D1%82%D0%B5%20%D1%84%D0%BB%D0%B5%D1%88%20%D0%B8%20%D0%B2%D1%81%D1%8E%20%D1%86%D0%B5%D0%BB%D0%B8%D0%BA%D0%BE%D0%BC.gif?raw=true" />
</p>

* На скриншотах роизводиться запись в 2 сектора 1й командой. При этом для целостности прочих данных выполняется следующий алгоритм работы с flash: вычитывается сектор выровненый по мин. затираемой области 4096 байт, новые данные замещаются в нем в нужном месте, потом старые и новые данные записываются обратно на флешь. Алгоритм работы смотреть по ссылке в doc файле ms Word97 https://github.com/NetDm/MCU-CLI-w25Q80-emulEEPROM/blob/master/remarks/%D0%90%D0%BB%D0%B3%D0%BE%D1%80%D0%B8%D1%82%D0%BC%20%D1%80%D0%B0%D0%B1%D0%BE%D1%82%D1%8B%20%D1%81%20%D1%81%D0%B5%D0%BA%D1%82%D0%BE%D1%80%D0%B0%D0%BC%D0%B8%20%D1%84%D0%BB%D0%B5%D1%88%20%D1%87%D0%B5%D1%80%D0%B5%D0%B7%20%D1%81%D1%82%D1%80%D0%B0%D0%BD%D0%B8%D1%86%D1%8B.doc

**В проекте содержаться:**

Блокирующая низкоуровневая библиотека базовых операций SPI FLASH w25Q80 в папке '**UserCodes/NvmSpi25Qxx**/'
  Cопутствующий файл '**UserCodes/w25q80def.h**' содержит настройки SPI flash

Неблокирующий автомат процесса записи потока из UART верхнего уровня **UserCodes/ApL/NVM25Q80.c** по средствам низкоуровневой библиотеки **NvmSpi25Qxx**

в случае подмены потока данных, функцией NVM25Q80.c::**pfStreamForErase(..)** производиться истирание произвольных ячеек


![изображение](https://user-images.githubusercontent.com/36101745/172089108-01100c97-7422-414b-867f-f83d7d966115.png)

Скриншот настроек тактовых частот, так-же содержиться в подкаталоге '/CLI25Q80/remarks/'
