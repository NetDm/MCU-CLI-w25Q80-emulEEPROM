# CLIw25Q80

Проект управления serial SPI FLASH w25Q80 эмуляция EEPROM по средствам консоли redLine CLI

Поддерживаются следующие операции: стирание всей микросхемы, стирание и перезапись произвольных байтов из потока консоли

Для управления процессами используется консоль redline CLI для MCU без RTOS с памятью комманд, редактором; удобным общим файлом списка комманд с мануалами (https://github.com/NetDm/CLIw25Q80/blob/master/UserCodes/CLIcommands.c), показываются при вызове man, см вывод команды: man man
Пример перезаписи данных в различные секторп произвольных адресов:
![изображение](https://user-images.githubusercontent.com/36101745/172067353-de8d5784-76c7-4e05-962f-c7a9ae3c2555.png)
Пример истирания флеш по произвольным адресам:
![изображение](https://user-images.githubusercontent.com/36101745/172067361-4b6e30f8-470a-4cec-add0-607cc083279c.png)

* На скриншетах видно, запись в 2 сектора 1й командой
* При этом для целостности выполняется следующий алгоритм работы с flash: вычитывается сектор выровненый по мин. затираемой области 4096 байт, новые данные замещаются в нем в нужном месте, потом старые и новые данные записываются обратно на флешь. Алгоритм работы смотреть по ссылке в doc файле ms Word97 https://github.com/NetDm/MCU-CLI-w25Q80-emulEEPROM/blob/master/remarks/%D0%90%D0%BB%D0%B3%D0%BE%D1%80%D0%B8%D1%82%D0%BC%20%D1%80%D0%B0%D0%B1%D0%BE%D1%82%D1%8B%20%D1%81%20%D1%81%D0%B5%D0%BA%D1%82%D0%BE%D1%80%D0%B0%D0%BC%D0%B8%20%D1%84%D0%BB%D0%B5%D1%88%20%D1%87%D0%B5%D1%80%D0%B5%D0%B7%20%D1%81%D1%82%D1%80%D0%B0%D0%BD%D0%B8%D1%86%D1%8B.doc

**В проекте содержаться:**

Блокирующая низкоуровневая библиотека базовых операций SPI FLASH w25Q80 в папке '**UserCodes/NvmSpi25Qxx**/'
  Cопутствующий файл '**UserCodes/w25q80def.h**' содержит настройки SPI flash

Неблокирующий автомат процесса записи потока из UART верхнего уровня **UserCodes/ApL/NVM25Q80.c** по средствам низкоуровневой библиотеки **NvmSpi25Qxx**

в случае подмены потока данных, функцией NVM25Q80.c::**pfStreamForErase(uint8_t*)** производиться истирание произвольных ячеек
